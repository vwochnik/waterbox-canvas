var Waterbox=function(t){"use strict";const e={width:!1,height:!1,value:!1,backColorScheme:!1,waterColorScheme:!1,frontColorScheme:!0,backPattern:!0,waterPattern:!0,frontPattern:!0,strokeWidth:!1,scale:!0,clipEdges:!1},r={width:100,height:200,value:0,backColorScheme:{fill:"#8d8d9f",stroke:"#8a8a9a",contrast:.1},waterColorScheme:{fill:"rgba(58, 123, 213, 0.9)",stroke:"rgba(42, 92, 160, 0.9)",contrast:.1},backPattern:void 0,waterPattern:void 0,frontPattern:void 0,strokeWidth:1,clipEdges:!1};function n(t,e,r){return Math.min(Math.max(t,r),e)}class o extends Error{constructor(t){super(`Failed to parse color: "${t}"`)}}var i=o;function a(t){if("string"!=typeof t)throw new i(t);if("transparent"===t.trim().toLowerCase())return[0,0,0,0];let e=t.trim();e=d.test(t)?function(t){const e=t.toLowerCase().trim(),r=c[function(t){let e=5381,r=t.length;for(;r;)e=33*e^t.charCodeAt(--r);return(e>>>0)%2341}(e)];if(!r)throw new i(t);return`#${r}`}(t):t;const r=f.exec(e);if(r){const t=Array.from(r).slice(1);return[...t.slice(0,3).map(t=>parseInt(s(t,2),16)),parseInt(s(t[3]||"f",2),16)/255]}const o=h.exec(e);if(o){const t=Array.from(o).slice(1);return[...t.slice(0,3).map(t=>parseInt(t,16)),parseInt(t[3]||"ff",16)/255]}const a=u.exec(e);if(a){const t=Array.from(a).slice(1);return[...t.slice(0,3).map(t=>parseInt(t,10)),parseFloat(t[3]||"1")]}const l=w.exec(e);if(l){const[e,r,o,a]=Array.from(l).slice(1).map(parseFloat);if(n(0,100,r)!==r)throw new i(t);if(n(0,100,o)!==o)throw new i(t);return[...g(e,r,o),Number.isNaN(a)?1:a]}throw new i(t)}const l=t=>parseInt(t.replace(/_/g,""),36),c="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((t,e)=>{const r=l(e.substring(0,3)),n=l(e.substring(3)).toString(16);let o="";for(let t=0;t<6-n.length;t++)o+="0";return t[r]=`${o}${n}`,t},{});const s=(t,e)=>Array.from(Array(e)).map(()=>t).join(""),f=new RegExp(`^#${s("([a-f0-9])",3)}([a-f0-9])?$`,"i"),h=new RegExp(`^#${s("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),u=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${s(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),w=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,d=/^[a-z]+$/i,_=t=>Math.round(255*t),g=(t,e,r)=>{let n=r/100;if(0===e)return[n,n,n].map(_);const o=(t%360+360)%360/60,i=(1-Math.abs(2*n-1))*(e/100),a=i*(1-Math.abs(o%2-1));let l=0,c=0,s=0;o>=0&&o<1?(l=i,c=a):o>=1&&o<2?(l=a,c=i):o>=2&&o<3?(c=i,s=a):o>=3&&o<4?(c=a,s=i):o>=4&&o<5?(l=a,s=i):o>=5&&o<6&&(l=i,s=a);const f=n-i/2;return[l+f,c+f,s+f].map(_)};function p(t,e){const[r,o,i,l]=function(t){const[e,r,n,o]=a(t).map((t,e)=>3===e?t:t/255),i=Math.max(e,r,n),l=Math.min(e,r,n),c=(i+l)/2;if(i===l)return[0,0,c,o];const s=i-l;return[60*(e===i?(r-n)/s+(r<n?6:0):r===i?(n-e)/s+2:(e-r)/s+4),c>.5?s/(2-i-l):s/(i+l),c,o]}(t);return function(t,e,r,o){return`hsla(${(t%360).toFixed()}, ${n(0,100,100*e).toFixed()}%, ${n(0,100,100*r).toFixed()}%, ${parseFloat(n(0,1,o).toFixed(3))})`}(r,o,i-e,l)}function y(t){return j(t,!0,1),t}function b(t){return j(t,!0,0,100),t}function k(t){var e;return E(e=t),P(e,["fill","stroke"],!1),$(e.fill),$(e.stroke),"contrast"in e?(P(e,["fill","stroke","contrast"],!0),j(e.contrast,!1,0,1)):(P(e,["fill","stroke","lighter","darker"],!0),$(e.lighter),$(e.darker)),t}function m(t){if(void 0!==t)return k(t)}function v(t){var e;if(void 0!==t)return E(e=t),"name"in e?(P(e,["name","size","alpha"],!0),S(e.name),j(e.size,!1,0),j(e.alpha,!1,0,1)):(P(e,["creator"],!0),function(t){if("function"!=typeof t)throw new Error("Expected a function")}(e.creator)),t}function x(t){return j(t,!1,0),t}function z(t){var e;if(void 0!==t)return E(e=t),P(e,["divisions","size"],!0),j(e.divisions,!0,2),j(e.size,!1,0,1),t}function C(t){return function(t){if("boolean"!=typeof t)throw new Error("Expected a boolean")}(t),t}function j(t,e,r,n){if(e){if(!Number.isInteger(t))throw new Error("Not an integer")}else if(!Number.isFinite(t))throw new Error("Not a number");const o=t;if(void 0!==r&&o<r)throw new Error(`Number must be greater than or equal to ${r}`);if(void 0!==n&&o>n)throw new Error(`Number must be less than or equal to ${n}`)}function E(t){if("object"!=typeof t||null===t)throw new Error("Not an object")}function P(t,e,r){E(t);const n=Object.keys(t),o=e.filter(t=>!n.includes(t));if(o.length>0)throw new Error(`Missing keys: "${o.join(", ")}"`);if(r&&n.length!==e.length){const t=n.filter(t=>!e.includes(t));throw new Error(`Unexpected keys: ${t.join(", ")}`)}}function S(t){if("string"!=typeof t)throw new Error("Not a string")}function $(t){S(t);try{a(t)}catch(t){if(t instanceof i)throw t;throw new Error("Invalid color")}}function M(t,e){if("name"in e){const r=function(t,e,r){switch(t){case"blocky":return q(e||10,r);case"noise":return q(e||1,r);case"dotted":return function(t,e){const r=4*t,n=4*t,o=.1*t,i=new OffscreenCanvas(r,n),a=i.getContext("2d");if(!a)throw new Error("Failed to get 2D context");a.save();const l=Math.max(1,Math.round(r/t)),c=Math.max(1,Math.round(n/t)),s=r/l,f=n/c,h=s/2,u=f/2;a.fillStyle="white",a.globalAlpha=e;for(let t=u;t<n+1e-4;t+=f)for(let e=h;e<r+1e-4;e+=s)a.beginPath(),a.arc(e,t,o,0,2*Math.PI),a.fill();return a.restore(),i}(e||10,r);case"grid":return function(t,e){const r=4*t,n=4*t,o=new OffscreenCanvas(r,n),i=o.getContext("2d");if(!i)throw new Error("Failed to get 2D context");i.save(),i.strokeStyle="white",i.lineWidth=.05*t,i.globalAlpha=e;for(let e=0;e<=r;e+=t)i.beginPath(),i.moveTo(e+.5,0),i.lineTo(e+.5,n),i.stroke();for(let e=0;e<=n;e+=t)i.beginPath(),i.moveTo(0,e+.5),i.lineTo(r,e+.5),i.stroke();return i.restore(),o}(e||10,r);case"checkered":return function(t,e){const r=new OffscreenCanvas(2*t,2*t),n=r.getContext("2d");if(!n)throw new Error("Failed to get 2D context");n.save(),n.globalAlpha=e;for(let e=0;e<2;e++)for(let r=0;r<2;r++)n.fillStyle=(r+e)%2==0?"#ffffff":"#000000",n.fillRect(r*t,e*t,t,t);return n.restore(),r}(e||10,r);case"debug":return function(t,e){const r=new OffscreenCanvas(2*t,2*t),n=r.getContext("2d");if(!n)throw new Error("Failed to get 2D context");n.save(),n.globalAlpha=e;const o=Math.hypot(t,t),i=n.createRadialGradient(t,t,0,t,t,o);return i.addColorStop(0,"red"),i.addColorStop(.25,"yellow"),i.addColorStop(.5,"green"),i.addColorStop(1,"blue"),n.fillStyle=i,n.fillRect(0,0,2*t,2*t),n.restore(),r}(e||10,r);default:throw new Error(`unknown pattern name: ${t}`)}}(e.name,e.size,e.alpha),n=t.createPattern(r,"repeat");if(!n)throw new Error("Failed to create pattern");return n??void 0}return e.creator(t)}function q(t,e){const r=64*t,n=64*t,o=new OffscreenCanvas(r,n),i=o.getContext("2d");if(!i)throw new Error("Failed to get 2D context");const a=Math.ceil(r/t),l=Math.ceil(n/t);i.save();for(let o=0;o<l;o++)for(let l=0;l<a;l++){const a=Math.random()*e;i.fillStyle=`rgba(255,255,255,${a})`;const c=l*t,s=o*t,f=Math.min(t,r-c),h=Math.min(t,n-s);i.fillRect(c,s,f,h)}return i.restore(),o}function O(t,e,r,n,o,i,a){const{width:l,height:c,value:s,strokeWidth:f,clipEdges:h,scale:u}=t,w=R(t.backColorScheme),d=R(t.waterColorScheme),_=t.frontColorScheme?R(t.frontColorScheme):void 0,g=Math.min(l,c),p={x:l/2-g/2+f/2,y:f/2,w:g-f-1,h:c-f-1},y={w:p.w,h:p.w/2};r.clearRect(0,0,l,c);const b={x:p.x,y:p.y+p.h-y.h,w:y.w,h:y.h},k={x:p.x,y:p.y,w:y.w/2,h:p.h},m={x:p.x+p.w/2,y:p.y,w:y.w/2,h:p.h};if(F(r,[t=>{I(t,b,"bottom")},t=>{A(t,k,y,0,-y.h/2,"back")},t=>{A(t,m,y,-y.h/2,0,"back")}],(u?function(t){const e=100/t;return Array.from({length:t-1},(t,r)=>e*(r+1))}(u.divisions).map(t=>({x:p.x,y:p.y+p.h-y.h-(p.h-y.h)*t/100,w:y.w,h:y.h})):[]).map(t=>e=>function(t,e,r){const n=r/2;t.beginPath(),t.moveTo(e.x+e.w/2-e.w*n,e.y+e.h*n),t.lineTo(e.x+e.w/2,e.y),t.lineTo(e.x+e.w/2+e.w*n,e.y+e.h*n)}(e,t,u?.size??0)),[w.fill,w.lighter??w.fill,w.darker??w.fill],w.stroke,f,h,n,l,c,o),s>0){const t=y.h+s/100*(p.h-y.h),e={x:p.x,y:p.y+p.h-t,w:y.w/2,h:t},o={x:p.x+p.w/2,y:p.y+p.h-t,w:y.w/2,h:t},a={x:p.x,y:p.y+p.h-t,w:y.w,h:y.h};F(r,[t=>{A(t,e,y,0,y.h/2,"front")},t=>{A(t,o,y,y.h/2,0,"front")},t=>{I(t,a,"top")}],[],[d.darker??d?.fill,d.lighter??d.fill,d.fill],d.stroke,f,h,n,l,c,i)}if(_){const t={x:p.x,y:p.y,w:y.w/2,h:p.h},e={x:p.x+p.w/2,y:p.y,w:y.w/2,h:p.h},o={x:p.x,y:p.y,w:y.w,h:y.h};F(r,[e=>{A(e,t,y,0,y.h/2,"front")},t=>{A(t,e,y,y.h/2,0,"front")},t=>{I(t,o,"top")}],[],[_.darker??_.fill,_.lighter??_.fill,_.fill],_.stroke,f,h,n,l,c,a)}e.clearRect(0,0,l,c),e.drawImage(r.canvas,0,0)}function F(t,e,r,n,o,i,l,c,s,f,h){e.forEach((e,r)=>{!function(t,e,r,n,o,i,a){t.save(),a?(n.save(),n.clearRect(0,0,o,i),e(n),n.fillStyle=r,n.fill(),n.globalCompositeOperation="overlay",n.fillStyle=a,n.fill(),n.globalCompositeOperation="source-over",n.restore(),t.drawImage(n.canvas,0,0)):(e(t),t.fillStyle=r,t.fill());t.restore()}(t,e,n[r],c,s,f,h)}),function(t,e,r,n,o,i,l,c){i.clearRect(0,0,l,c),i.lineWidth=n,i.lineCap="round",i.lineJoin="round";const s=o?`rgba(0,0,0,${f=r,a(f)[3]})`:r;var f;e.forEach((t,e)=>{i.save(),t(i),i.restore(),i.globalCompositeOperation="destination-out",i.strokeStyle="black",i.stroke(),i.globalCompositeOperation="source-over",i.strokeStyle=s,i.stroke()}),o&&(t.globalCompositeOperation="destination-out");t.drawImage(i.canvas,0,0),t.globalCompositeOperation="source-over"}(t,[...e,...r],o,i,l,c,s,f)}function I(t,e,r){const n=.5*Math.hypot(e.w,e.h),o=Math.sqrt(2*n*n);t.translate(e.x+e.w/2,e.y+e.h/2),t.scale(e.w/o,e.h/o),t.rotate(Math.PI/4),t.beginPath(),t.rect(-n/2,-n/2,n,n),"top"===r?t.translate(-n/2,-n/2+2*n):t.translate(n/2-2*n,n/2)}function A(t,e,r,n,o,i){const a=e.x,l=e.y+r.h/2,c=e.w,s=e.h-r.h,f=0===c?0:(o-n)/c;t.translate(a,l+n),t.transform(1,f,0,1,0,0),t.beginPath(),t.rect(0,0,c,s),t.translate(-a,"back"===i?s:0);const h=c/Math.hypot(o-n,c);t.scale(h,1)}function R(t){return"contrast"in t?{fill:p(t.fill,0),stroke:p(t.stroke,0),lighter:(e=t.fill,r=t.contrast,p(e,-r)),darker:p(t.fill,t.contrast)}:{...t};var e,r}function N(){const t=new OffscreenCanvas(0,0),e=t.getContext("2d");if(!e)throw new Error("can't get context");return[t,e]}return t.createWaterbox=function(t){let n;const o=function(t){const e=t.getContext("2d");if(!e)throw new Error("can't get context");return e}(t),[i,a]=N(),[l,c]=N();let s,f,h;return function(t,e,r,n,o){let i;function a(t,r){const a=t.reduce((t,n)=>{const i=r[n];if(void 0===i){if(!e[n])throw new Error(`Invalid ${n}: Required option cannot be undefined`);delete t[n]}else{const e=o?.[n];try{t[n]=e?e(i):i}catch(t){if(t instanceof Error)throw new Error(`Invalid ${n}: ${t.message}`)}}return t},{...i});n?.(t,{...a}),i=a}return Object.keys(e).forEach(e=>{t[e]=function(r){return 0===arguments.length?i[e]:(a([e],{[e]:r}),t)}}),t.options=function(e){return 0===arguments.length?{...i}:(a(Object.keys(e),e),t)},a(Object.keys(e),r),t}({render:function(){O(n,o,a,c,s,f,h)}},e,r,function(e,r){n=r,e.includes("width")&&(t.width=n.width,i.width=n.width,l.width=n.width),e.includes("height")&&(t.height=n.height,i.height=n.height,l.height=n.height),e.includes("backPattern")&&(s=n.backPattern?M(a,n.backPattern):void 0),e.includes("waterPattern")&&(f=n.waterPattern?M(a,n.waterPattern):void 0),e.includes("frontPattern")&&(h=n.frontPattern?M(a,n.frontPattern):void 0)},{width:y,height:y,value:b,backColorScheme:k,waterColorScheme:k,frontColorScheme:m,backPattern:v,waterPattern:v,frontPattern:v,scale:z,strokeWidth:x,clipEdges:C})},t.defaultOptions=r,t.optionsWithOptionality=e,t}({});
